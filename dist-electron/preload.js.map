{"version":3,"file":"preload.js","sources":["../electron/preload.js"],"sourcesContent":["/* eslint-disable */\n// Código de preload modificado para funcionar tanto en producción como en desarrollo\nconst { contextBridge, ipcRenderer } =\n  typeof require !== \"undefined\" ? require(\"electron\") : window.electron;\n\n// Función para mostrar logs en la consola\nconst log = (msg, ...args) => {\n  console.log(`[Preload] ${msg}`, ...args);\n};\n\n// Agregar diagnóstico cuando se inicia la aplicación\nconsole.log(\"🔍 [DIAGNÓSTICO] Preload script iniciado\");\n\ntry {\n  console.log(\"🔍 [DIAGNÓSTICO] Entorno:\", process.env.NODE_ENV);\n  console.log(\"🔍 [DIAGNÓSTICO] Plataforma:\", process.platform);\n  console.log(\"🔍 [DIAGNÓSTICO] Versión de Electron:\", process.versions.electron);\n  console.log(\"🔍 [DIAGNÓSTICO] Versión de Node:\", process.versions.node);\n  console.log(\"🔍 [DIAGNÓSTICO] Directorio de ejecución:\", process.cwd());\n  \n  if (process.env.APPDATA) {\n    console.log(\"🔍 [DIAGNÓSTICO] Directorio APPDATA:\", process.env.APPDATA);\n    console.log(\"🔍 [DIAGNÓSTICO] Ruta probable de la base de datos:\", \n      require('path').join(process.env.APPDATA, 'sistema-inventario', 'inventory-database.sqlite'));\n  }\n\n  log(\"Inicializando preload.js\");\n\n  // Intentar exponer la API a través de contextBridge\n  contextBridge.exposeInMainWorld(\"electronAPI\", {\n    // Productos\n    getAllProducts: () => {\n      log(\"Llamando a getAllProducts\");\n      return ipcRenderer.invoke(\"get-all-products\");\n    },\n    getAllActiveProducts: () => {\n      log(\"Llamando a getAllActiveProducts\");\n      return ipcRenderer.invoke(\"get-all-active-products\");\n    },\n    getProductById: (id) => {\n      log(\"Llamando a getProductById:\", id);\n      return ipcRenderer.invoke(\"get-product-by-id\", id);\n    },\n    getProductByBarcode: (barcode) => {\n      log(\"Llamando a getProductByBarcode:\", barcode);\n      return ipcRenderer.invoke(\"get-product-by-barcode\", barcode);\n    },\n    createProduct: (productData) => {\n      log(\"Llamando a createProduct\");\n      return ipcRenderer.invoke(\"create-product\", productData);\n    },\n    updateProduct: (id, productData) => {\n      log(\"Llamando a updateProduct - ID:\", id);\n      return ipcRenderer.invoke(\"update-product\", { id, productData });\n    },\n    deleteProduct: (id) => {\n      log(\"Llamando a deleteProduct:\", id);\n      return ipcRenderer.invoke(\"delete-product\", id);\n    },\n    searchProducts: (query) => {\n      log(\"Llamando a searchProducts:\", query);\n      return ipcRenderer.invoke(\"search-products\", query);\n    },\n    updateProductsAfterSync: (syncResults) => {\n      log(\"Llamando a updateProductsAfterSync\");\n      return ipcRenderer.invoke(\"update-products-after-sync\", syncResults);\n    },\n    purgeDeletedProducts: () => {\n      log(\"Llamando a purgeDeletedProducts\");\n      return ipcRenderer.invoke(\"purge-deleted-products\");\n    },\n\n    // Categorías\n    getAllCategories: () => {\n      log(\"Llamando a getAllCategories\");\n      return ipcRenderer.invoke(\"get-all-categories\");\n    },\n    getCategoryById: (id) => {\n      log(\"Llamando a getCategoryById:\", id);\n      return ipcRenderer.invoke(\"get-category-by-id\", id);\n    },\n    createCategory: (categoryData) => {\n      log(\"Llamando a createCategory\");\n      return ipcRenderer.invoke(\"create-category\", categoryData);\n    },\n    updateCategory: (id, categoryData) => {\n      log(\"Llamando a updateCategory - ID:\", id);\n      return ipcRenderer.invoke(\"update-category\", { id, categoryData });\n    },\n    deleteCategory: (id) => {\n      log(\"Llamando a deleteCategory:\", id);\n      return ipcRenderer.invoke(\"delete-category\", id);\n    },\n    // Nuevos métodos para sincronización de categorías\n    updateCategoriesAfterSync: (syncResults) => {\n      log(\"Llamando a updateCategoriesAfterSync\");\n      return ipcRenderer.invoke(\"update-categories-after-sync\", syncResults);\n    },\n    purgeDeletedCategories: () => {\n      log(\"Llamando a purgeDeletedCategories\");\n      return ipcRenderer.invoke(\"purge-deleted-categories\");\n    },\n  });\n\n  log(\"preload.js inicializado correctamente\");\n} catch (error) {\n  console.error(\"[Preload] Error al inicializar:\", error);\n}\n"],"names":[],"mappings":"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"}